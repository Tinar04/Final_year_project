<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Health and Lifestyle Form (22–60)</title>
    <style>
      body {
        font-family: "Inter", system-ui, -apple-system, sans-serif;
        background: url("/static/images/login-bg.jpg") center/cover no-repeat
          fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        color: #111827;
      }

      .card {
        background: #fff;
        width: 90%;
        max-width: 720px;
        padding: 40px 50px;
        border-radius: 18px;
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.1);
      }

      h2 {
        text-align: center;
        font-size: 1.9rem;
        font-weight: 600;
        margin-bottom: 8px;
        color: #1f2937;
      }

      p.subtitle {
        text-align: center;
        color: #6b7280;
        margin-bottom: 30px;
        font-size: 1rem;
      }

      label {
        display: block;
        font-weight: 600;
        margin-bottom: 10px;
        color: #1f2937;
      }

      input,
      select {
        width: 100%;
        padding: 10px 14px;
        margin-bottom: 18px;
        border-radius: 10px;
        border: 1px solid #d1d5db;
        font-size: 0.95rem;
        background-color: #fff;
        outline: none;
        color: #111827;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
      }
      #Sleep_Quality,
      #Alcohol_Intake,
      #Social_Interactions {
        padding: 1px 1px;
      }

      select:focus,
      input:focus {
        border-color: #6366f1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
      }

      .question {
        background-color: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 18px 20px;
        margin-bottom: 20px;
      }

      .range-control {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      /* Styled, modern slider track */
      input[type="range"] {
        flex: 1;
        -webkit-appearance: none;
        appearance: none;
        height: 1px;
        border-radius: 999px;
        background: linear-gradient(to right, #d1d5db 0%, #d1d5db 100%);
        outline: none;
        transition: background 0.25s ease;
      }

      /* Chrome/Safari */
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #5b21b6; /* purple */
        border: 3px solid #fff;
        box-shadow: 0 3px 8px rgba(91, 33, 182, 0.2);
        cursor: pointer;
        transition: transform 0.12s ease;
      }

      input[type="range"]::-webkit-slider-thumb:active {
        transform: scale(0.98);
      }

      /* Firefox */
      input[type="range"]::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #5b21b6;
        border: 3px solid #fff;
        box-shadow: 0 3px 8px rgba(91, 33, 182, 0.2);
        cursor: pointer;
      }

      /* Plus/minus circular buttons */
      button.adjust {
        width: 36px;
        height: 36px;
        border: none;
        border-radius: 50%;
        background: #f1f5f9;
        font-weight: 700;
        font-size: 18px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: background 0.15s, transform 0.12s;
      }

      button.adjust:hover {
        background: #e2e8f0;
        transform: translateY(-1px);
      }

      .value {
        min-width: 36px;
        text-align: center;
        font-weight: 700;
        font-size: 1rem;
        color: #374151;
      }

      button.submit {
        width: 100%;
        background: linear-gradient(to right, #6366f1, #8b5cf6);
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 12px 0;
        font-weight: 600;
        margin-top: 25px;
        cursor: pointer;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }

      button.submit:hover {
        transform: translateY(-1px);
        opacity: 0.95;
      }

      @media (max-width: 600px) {
        .card {
          padding: 28px 22px;
        }
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>Health and Lifestyle Data Form (22–60)</h2>
      <p class="subtitle">
        Please fill out your lifestyle and health details carefully.
      </p>

      <form method="POST" action="/quiz_22_60" id="quizForm">
        <label>Age:</label>
        <input type="number" name="Age" required />

        <label>Gender:</label>
        <select name="Gender" required>
          <option value="">Select</option>
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>

        <label>Occupation:</label>
        <input
          type="text"
          name="Occupation"
          placeholder="e.g., Software Engineer"
          required
        />

        <label>Marital Status:</label>
        <select name="Marital_Status" required>
          <option value="">Select</option>
          <option>Single</option>
          <option>Married</option>
          <option>Divorced</option>
          <option>Widowed</option>
        </select>

        <label>Sleep Duration (hours):</label>
        <input
          type="number"
          name="Sleep_Duration"
          min="1"
          max="10"
          step="0.5"
          required
        />

        <!-- Sleep Quality Slider (0–7) -->
        <div class="question">
          <label>Sleep Quality (0–7)</label>
          <div class="range-control">
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Sleep_Quality', -1)"
            >
              −
            </button>
            <input
              type="range"
              id="Sleep_Quality"
              name="Sleep_Quality"
              min="0"
              max="7"
              step="1"
              value="3"
            />
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Sleep_Quality', 1)"
            >
              +
            </button>
            <span class="value" id="Sleep_Quality_val">3</span>
          </div>
        </div>

        <label>Wake Up Time:</label>
        <input type="time" name="Wake_Up_Time" required />

        <label>Bed Time:</label>
        <input type="time" name="Bed_Time" required />

        <label>Physical Activity (hours per day):</label>
        <input
          type="number"
          name="Physical_Activity"
          min="0"
          max="7"
          step="0.5"
          required
        />

        <label>Screen Time (hours per day):</label>
        <input
          type="number"
          name="Screen_Time"
          min="0"
          max="24"
          step="0.5"
          required
        />

        <label>Caffeine Intake (cups per day):</label>
        <input type="number" name="Caffeine_Intake" min="0" max="4" required />

        <div class="question">
          <label>Alcohol Intake (0–2)</label>
          <div class="range-control">
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Alcohol_Intake', -1)"
            >
              −
            </button>
            <input
              type="range"
              id="Alcohol_Intake"
              name="Alcohol_Intake"
              min="0"
              max="2"
              step="1"
              value="0"
            />
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Alcohol_Intake', 1)"
            >
              +
            </button>
            <span class="value" id="Alcohol_Intake_val">0</span>
          </div>
        </div>

        <label>Smoking Habit:</label>
        <select name="Smoking_Habit" required>
          <option value="">Select</option>
          <option>Yes</option>
          <option>No</option>
        </select>

        <label>Work Hours (per day):</label>
        <input type="number" name="Work_Hours" min="3" max="14" required />

        <label>Travel Time (hours per day):</label>
        <input type="number" name="Travel_Time" min="0" max="24" required />

        <div class="question">
          <label>Social Interaction (0–7)</label>
          <div class="range-control">
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Social_Interactions', -1)"
            >
              −
            </button>
            <input
              type="range"
              id="Social_Interactions"
              name="Social_Interactions"
              min="0"
              max="7"
              step="1"
              value="3"
            />
            <button
              type="button"
              class="adjust"
              onclick="adjustValue('Social_Interactions', 1)"
            >
              +
            </button>
            <span class="value" id="Social_Interactions_val">3</span>
          </div>
        </div>

        <label>Meditation Practice:</label>
        <select name="Meditation_Practice" required>
          <option value="">Select</option>
          <option>Yes</option>
          <option>No</option>
        </select>

        <label>Exercise Type:</label>
        <select name="Exercise_Type" required>
          <option value="">Select</option>
          <option>Aerobics</option>
          <option>Cardio</option>
          <option>Meditation</option>
          <option>Pilates</option>
          <option>Strength Training</option>
          <option>Walking</option>
          <option>Yoga</option>
          <option>None</option>
        </select>

        <label
          >Blood Pressure
          <small style="color: #6b7280"
            >(Allowed: 109–170 systolic / any diastolic)</small
          ></label
        >
        <input
          type="text"
          name="Blood_Pressure"
          placeholder="e.g., 118/76"
          min="109"
          max="170"
          required
          style="margin-bottom: 16px"
        />

        <label>Cholesterol Level (150–290 mg/dL)</label>
        <input
          type="number"
          name="Cholesterol_Level"
          min="150"
          max="290"
          placeholder="e.g., 170"
          required
          style="margin-bottom: 16px"
        />

        <label>Blood Sugar Level (78–151 mg/dL)</label>
        <input
          type="number"
          name="Blood_Sugar_Level"
          min="78"
          max="151"
          placeholder="e.g., 95"
          required
          style="margin-bottom: 16px"
        />

        <button type="submit" class="submit">Submit</button>
      </form>
    </div>

    <script>
      // Robust slider updater + +/- adjuster
      function updateValue(id) {
        const slider = document.getElementById(id);
        const valueSpan = document.getElementById(id + "_val");
        if (!slider || !valueSpan) return;

        const rawVal = Number(slider.value);
        const min = Number(slider.min);
        const max = Number(slider.max);
        const step = slider.step ? Number(slider.step) : 1;

        // Display format (integers when step is integer)
        const display =
          Math.abs(step - Math.round(step)) < 1e-8
            ? Math.round(rawVal)
            : rawVal;
        valueSpan.textContent = display;

        // Safe ratio
        const ratio = max === min ? 0 : (rawVal - min) / (max - min);

        // Color logic
        let color;
        if (ratio <= 0.33) color = "#10b981"; // green
        else if (ratio <= 0.66) color = "#f59e0b"; // orange
        else color = "#ef4444"; // red

        const pct = Math.max(0, Math.min(100, ratio * 100));
        slider.style.background = `linear-gradient(to right, ${color} ${pct}%, #e5e7eb ${pct}%)`;

        valueSpan.style.color = color;
        slider.setAttribute("aria-valuenow", rawVal);
      }

      function adjustValue(id, deltaSteps) {
        const slider = document.getElementById(id);
        if (!slider) return;
        const min = Number(slider.min);
        const max = Number(slider.max);
        const step = slider.step ? Number(slider.step) : 1;
        let val = Number(slider.value) + deltaSteps * step;
        val = Math.max(min, Math.min(max, val));
        // if integer step, round to integer
        if (Math.abs(step - Math.round(step)) < 1e-8) val = Math.round(val);
        slider.value = val;
        updateValue(id);
      }

      // Initialize on DOMContentLoaded
      window.addEventListener("DOMContentLoaded", () => {
        // Initialize sliders and hook events
        document.querySelectorAll('input[type="range"]').forEach((slider) => {
          // ensure slider has id
          if (!slider.id && slider.name) slider.id = slider.name;
          const id = slider.id;
          // ensure there's a value span (if not present, skip — your template has spans)
          const valSpan = document.getElementById(id + "_val");
          if (!valSpan) {
            const span = document.createElement("span");
            span.className = "value";
            span.id = id + "_val";
            slider.parentNode.appendChild(span);
          }
          // update initially
          updateValue(id);
          // update on input
          slider.addEventListener("input", () => updateValue(id));
        });

        // restore age/gender from localStorage if present
        const ageField = document.querySelector('input[name="Age"]');
        const genderField = document.querySelector('select[name="Gender"]');
        const savedAge = localStorage.getItem("user_age");
        const savedGender = localStorage.getItem("user_gender");
        if (savedAge && ageField) ageField.value = savedAge;
        if (savedGender && genderField) {
          genderField.value =
            savedGender.charAt(0).toUpperCase() + savedGender.slice(1);
        }

        // save-clearing on submit
        const form = document.getElementById("quizForm");
        if (form) {
          form.addEventListener("submit", () => {
            localStorage.removeItem("user_age");
            localStorage.removeItem("user_gender");
          });
        }
      });
    </script>
  </body>
</html>
